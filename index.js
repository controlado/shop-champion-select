(function(){"use strict";try{if(typeof document<"u"){var i=document.createElement("style");i.appendChild(document.createTextNode(".mini-icon-champion{display:none;position:relative;height:100%;flex-shrink:0;margin-left:2px;box-sizing:border-box;background-size:contain}.mini-icon-img{position:inherit;height:100%;border:1px solid #46371487;width:inherit;overflow:hidden;object-fit:cover;box-sizing:border-box;background-color:#010a13}.mini-icon-img:hover{border-image:linear-gradient(to top,#46371487 0%,#695625 23%,#b88d35 93%,#c8aa6e 100%) 1}.champion-grid .champion-grid-header .champion-input{height:25px}")),document.head.appendChild(i)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();
/**
 * @author balaclava
 * @name shop-champion-select
 * @link https://github.com/controlado/shop-champion-select#readme
 * @description Buy champions inside Champion Select! 🐧
 * @version 6.6.0
 * @license GPL-3.0-or-later
 */
import{addRoutines as w,request as p,linkEndpoint as C,StoreBase as f,Champion as v,layerManager as h}from"https://cdn.skypack.dev/balaclava-utils@latest";const b="en",E={pt:`Botão esquerdo: compra o campeão
Botão direito: compra e seleciona o campeão`,es:`Botón izquierdo: compra el campeón
Botón derecho: compra y selecciona el campeón`,en:`Left click: buy the champion
Right click: buy and select the champion`},c={missing:b,tooltip:E};class L extends f{async getNotOwnedChampions(){return(await this.request("GET","/storefront/v3/view/champions")).data.catalog.filter(e=>!e.owned).map(e=>({...e,name:e.name.toLowerCase()}))}}class k{constructor(t){this.element=document.createElement("div"),this.element.classList.add("mini-icon-champion"),this.img=document.createElement("img"),this.img.classList.add("mini-icon-img"),this.element.appendChild(this.img),this.store=t,this.champion=null}setChampion(t){this.champion=new v(t.itemId,t.ip),this.img.src=`/lol-game-data/assets/v1/champion-icons/${this.champion.id}.png`}show(){this.element.style.display="block"}hide(){this.element.style.display="none"}}class R{constructor(t){this.element=document.createElement("div"),this.element.setAttribute("id","lol-uikit-tooltip-root"),this.element.classList.add("tooltip","tooltip-random-champion");const e=document.createElement("lol-uikit-tooltip");e.setAttribute("data-tooltip-position",t),e.setAttribute("type","system");const o=document.createElement("lol-uikit-content-block");o.setAttribute("type","tooltip-system");const s=document.createElement("p");s.innerText=this.getLabel(),o.appendChild(s),e.appendChild(o),this.element.appendChild(e)}getLabel(){const t=document.body.dataset.lang;return c.tooltip[t]||c.tooltip[c.missing]}show(t){const e=t.getBoundingClientRect();this.element.style.top=`${e.top+e.height-38}px`,this.element.style.left=`${e.left+e.width}px`,h.appendChild(this.element)}hide(){h.removeChild(this.element)}}class A{constructor(t,e){this.element=document.querySelector(t),this.store=e,this.champions=[]}async refreshPlaceholder(){const t=await p("GET","/lol-inventory/v1/wallet/lol_blue_essence"),{lol_blue_essence:e}=await t.json();this.element.setAttribute("placeholder",`BE: ${e}`)}async updateChampions(){const t=new Event("input");this.champions=await this.store.getNotOwnedChampions(),this.element.dispatchEvent(t)}getSearchedChampions(){const t=this.element.value.toLowerCase();return this.champions.filter(e=>e.name.startsWith(t))}}async function B(i,t){const e=document.querySelector(i);if(!e||e.hasAttribute(t))return;e.setAttribute(t,"true");const o=new L;await o.wait(400);const s=new A(".champion-input",o);await Promise.all([s.refreshPlaceholder(),s.updateChampions()]);const n=new k(o);e.appendChild(n.element);const m=new R("right");n.element.addEventListener("mouseleave",()=>m.hide()),n.element.addEventListener("mouseenter",()=>m.show(n.element)),n.element.addEventListener("click",()=>o.buyChampions(n.champion)),n.element.addEventListener("contextmenu",async()=>{if(!(await o.buyChampions(n.champion)).ok)return;const r=await p("GET","/lol-champ-select/v1/session"),{localPlayerCellId:d,actions:u}=await r.json();for(const y of u)for(const l of y)if(l.completed===!1&&l.actorCellId===d){const g={championId:n.champion.id,completed:!1};if((await p("PATCH",`/lol-champ-select/v1/session/actions/${l.id}`,{body:g})).ok)return}}),s.element.addEventListener("input",()=>{const a=s.getSearchedChampions();a.length===1?(n.setChampion(...a),n.show()):n.hide()}),C("/lol-inventory/v1/wallet",a=>{a.eventType==="Update"&&(s.refreshPlaceholder(),s.updateChampions(),console.debug("shop-champion-select: Refreshed champions"))})}addEventListener("load",()=>{w(()=>B(".champion-grid-header","shop-champion-select")),console.debug("shop-champion-select: Report bugs to Balaclava#1912")});
